---
layout: default
title: Lesson 6 - Multivariate analysis
parent: 3. Tutorial
nav_order: 6
description: A comprehensive guide to understanding epigenetics.
published: true
---
INCOMPLETE
{: .label .label-red }

{: .important-title }
> Aim
>
> Obtain a graph with the window distribution of methylation values across a chromosome in three contexts `CG`, `CHG` and `CHH`, using `bedtools`.

<br>
<details open markdown="block">
  <summary>
    <strong>Table of contents</strong>
  </summary>
  {: .text-delta }
- TOC
{:toc}
</details>
<br>

Multivariate analysis is a statistical approach that focuses on analyzing multiple variables of an experiment simultaneously. This technique is used to identify patterns, relationships and correlations between different variables as to detect the major combinations of factors that drive or influence the behavior of samples that are described by those variables. Relationships between samples that are described by those variables can also be identified using multivariate analysis methods. Thus, with this approach it is possible to sort the individual samples of an experiment (e.g. a number of animal or plants) into groups of samples that behave in a homogeneous way within each group but are differentiated between groups, according to the overall variables (characteristics) that describe those samples.

Among multivariate analysis methods, Principal Component Analysis stands out for popularity and broader use in scientific literature. It comes with different flavors, three of which will be briefly described in this mini-tutorial:

1.	Principal Components Analysis (in strict sense) or PCA
2.	Correspondence analysis or CA
3.	Multiple correspondence analysis or MCA

All these methods elaborate data to produce the so-called principal components, which represent a way to identify, sort and combine all the variables describing a dataset into a new set of fewer composite variables that are capable of dissecting most the of variability in the data.

Typical datasets that are prone to be analyzed by PCA are two-entry tables with individuals indicated in rows and numerical variables indicated in columns, like the following examples (Fig. 1):


°°°°

**Figure 1:** Examples of dataset amenable to PCA analysis

PCA is defined as an orthogonal linear transformation that transforms the data to a new coordinate system such that the greatest variance by some scalar projection of the data comes to lie on the first coordinate (called the first principal component), the second greatest variance on the second coordinate, and so on.

In more simple words, every single variable can be regarded as a coordinate in a multidimensional space. N variables represent a N-dimensions space in which the individual samples are located (Figure 2). Individuals with similar features share similar values in many or most variables and are expected to be located very close to each other in the multidimensional space. 

The PCA algorithm identifies variables that are most important to distinguish the samples, variables that are less influential and variable that are redundant with others. At the end of the process, the effects of distinct variables in representing the overall variability between samples will be algebraically combined in a smaller number of synthetic variables (dimensions or principal components) sorted by descending order, from the one that describes most the of variance present in the dataset to the one describing the least. Individual samples can be imagined as distributed in a new space with fewer dimensions than the original number of variables (Fig. 3). 

Each new principal component can be a combination of few or more original variables that are highly correlated to each other. Typically, the first two or three principal components (being the most informative synthetic variables generated by the algorithm) provide the x-y (or x-y-z) coordinates of a 2D (or 3D) space where individual samples can be plotted to identify clusters of samples with similar features. 

**Figure 2:** Dataset variables regarded as coordinates of individual samples into a multidimensional space.

**Figure 3:** Principal components regarded as new coordinates of individual samples into a simplified multidimensional space. The first two or three dimensions can suffice in representing a 2D or 3D (not shown) space where samples can be located to identify their proximity. 


## Differences between PCA, CA and MCA

**_Input dataset_**

PCA can be applied to individuals vs variables datasets with numerical and continuous variables (e.g. height, weight, concentration, intensity, etc.).

MCA can be applied to individuals vs variables datasets with categorical variables (e.g. “exposed to flood stress”: yes or no; “has a family history for the disease”: yes or no; etc.; “has a specific color”: blue, red or green).

CA is conceptually similar to MCA as it works with categorical variables but it is simplified down to a contingency table of categorical variables.  This kind of tables reports the numerical occurrences of different facts happening together (e.g. housekeeping activities vs members of the family responsible for them).

**_Main goal of the analysis_**

PCA and MCA are meant to (1) identify groups of individuals with similar prominent variables; (2) sort variables into very relevant and less relevant; (3) associate variables that are highly correlated or anti-correlated.

CA is only meant to (1) sort variables into very relevant and less relevant and (2) associate variables that are highly correlated or anti-correlated, as the information associating each single individual to each single variability is not directly available in the input dataset. 


R offers basic functions to perform PCA. However, here we will describe how to use two packages specialized in PCA, namely FactoMineR and factoextra.


```bash
# Move the working directory
cd /data2/student_space/st24_16_folder/epigenomics/

# Create a new directory for this tutorial
mkdir -p multivariate_analysis/

# Move inside the new directory
cd multivariate_analysis/

# Open the R session
R
```

```r
# Load the required libraries
library(FactoMineR)
library(factoextra)

```
FactoMineR is a package for Multivariate Analysis.

Factoextra is a package for data representation when performing Multivariate Analysis with FactoMineR. Factoextra requires and automatically uploads the ggplot2 graphics package, also part of the tidyverse suite.
